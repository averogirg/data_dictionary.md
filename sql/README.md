## üîç SQL-–∞–Ω–∞–ª–∏–∑: –æ—Ç–≤–µ—á–∞—é –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –±–∏–∑–Ω–µ—Å–∞

–í —ç—Ç–æ–π —á–∞—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ —è –ø–æ–∫–∞–∑—ã–≤–∞—é, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ , —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ –±–∏–∑–Ω–µ—Å–µ. –ù–∏–∂–µ - —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ **–ó–∞–ø—Ä–æ—Å—ã**, –∏—Ö —Å—É—Ç—å –∏ –∫–∞–∫—É—é –ø–æ–ª—å–∑—É –∏–∑ –Ω–∏—Ö –º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±—ã–ª–∏ –≤–∑—è—Ç—ã –∏–∑ –ø–∞–ø–∫–∏ **data** –≤ —Ç–∞–±–ª–∏—Ü–µ **superstore** –∏ —Å–≤—è–∑–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã **supplier**. –í–æ—Ç –∫–ª—é—á–µ–≤—ã–µ –∏–∑ –Ω–∏—Ö:

**–ö–ª—é—á–µ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ —á—Ç–æ —É–¥–∞–ª–æ—Å—å —É–∑–Ω–∞—Ç—å**

**1. –° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å? –ü–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥ –Ω–∞ –¥–∞–Ω–Ω—ã–µüëÄ**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –±—ã–ª–æ:** –ü–æ–Ω—è—Ç—å, –∫–∞–∫–æ–≥–æ –≤–∏–¥–∞ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å –≤ –±–∞–∑–µ.

**–ß—Ç–æ —è —Å–¥–µ–ª–∞–ª–∞:** –ü–æ—Å–º–æ—Ç—Ä–µ–ª–∞ –Ω–∞ –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Å—É–º–º—ã –∏ –¥–∞—Ç—ã.

**–ó–∞–ø—Ä–æ—Å:**

 **SELECT** * **FROM** superstore **LIMIT** 5;
 
 **–ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è:** –≠—Ç–æ –±–∞–∑–æ–≤—ã–π —à–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ –¥–µ–ª–∞—é—Ç –ø–µ—Ä–µ–¥ —Ä–∞–±–æ—Ç–æ–π —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤–∫–ª—é—á–∏–ª—Å—è –ª–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä, –ø—Ä–µ–∂–¥–µ —á–µ–º –Ω–∞—á–∏–Ω–∞—Ç—å –Ω–∞ –Ω—ë–º —Ä–∞–±–æ—Ç–∞—Ç—å.


**2. –ö–∞–∫–∏–µ —Ç–æ–≤–∞—Ä—ã —Å–∞–º—ã–µ –¥–æ—Ä–æ–≥–∏–µ?üìà**

**–í–æ–ø—Ä–æ—Å:** –ù–∞ –∫–∞–∫–∏–µ —Ç–æ–≤–∞—Ä—ã –∫–ª–∏–µ–Ω—Ç—ã —Ç—Ä–∞—Ç—è—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –¥–µ–Ω–µ–≥?

**–ß—Ç–æ —è —Å–¥–µ–ª–∞–ª–∞:** –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∞ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –ø–æ —Å—É–º–º–µ –ø—Ä–æ–¥–∞–∂, –æ—Ç —Å–∞–º—ã—Ö –∫—Ä—É–ø–Ω—ã—Ö –∫ –º–µ–Ω—å—à–∏–º.

**–ó–∞–ø—Ä–æ—Å**

**SELECT** product_name, sales **FROM** superstore **ORDER BY** sales **DESC**;

**–ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç:** –°—Ä–∞–∑—É –≤–∏–¥–Ω–æ —Ç–æ–ø —Å–∞–º—ã—Ö –ø—Ä–æ–¥–∞–≤–∞–µ–º—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å, –Ω–∞ —á—ë–º —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ —Ä–µ–∫–ª–∞–º–µ –∏ —á—Ç–æ —Ç–æ—á–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞ —Å–∫–ª–∞–¥–µ.


**3. –ö–∞–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è?**

**–í–æ–ø—Ä–æ—Å:** –ü—Ä–æ–¥–∞–∂–∏ –∫–∞–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏–Ω–æ—Å—è—Ç –±–∏–∑–Ω–µ—Å—É –æ—Å–Ω–æ–≤–Ω—É—é –≤—ã—Ä—É—á–∫—É?üìä

**–ß—Ç–æ —è —Å–¥–µ–ª–∞–ª–∞:** –°–ª–æ–∂–∏–ª–∞ –≤—ã—Ä—É—á–∫—É –ø–æ –≤—Å–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –ø–æ—Å—á–∏—Ç–∞–ª–∞, —Å–∫–æ–ª—å–∫–æ –±—ã–ª–æ –∑–∞–∫–∞–∑–æ–≤ –≤ –∫–∞–∂–¥–æ–π.

**–ó–∞–ø—Ä–æ—Å**

**SELECT** category, **SUM(sales)** as total_sales, **COUNT(*)** as orders_count

**FROM** superstore

**GROUP BY** category

**ORDER BY** total_sales **DESC**;

**–ì–ª–∞–≤–Ω—ã–π –≤—ã–≤–æ–¥:** –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ú–µ–±–µ–ª—å (Furniture) - —Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è. –û–Ω–∞ –¥–∞—ë—Ç –æ–∫–æ–ª–æ 40% –æ—Ç –≤—Å–µ–π –≤—ã—Ä—É—á–∫–∏, –ø—Ä–∏ —ç—Ç–æ–º –∑–∞–∫–∞–∑–æ–≤ –ø–æ –Ω–µ–π –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —Ç–æ–≤–∞—Ä—ã –≤ –Ω–µ–π –¥–æ—Ä–æ–≥–∏–µ –∏ –Ω–∞ –Ω–∏—Ö —Å—Ç–æ–∏—Ç –¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É.


**4. –ö—Ç–æ –Ω–∞—à–∏ –≥–ª–∞–≤–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã?**

**–ó–∞–¥–∞—á–∞:** –ù–∞–π—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—Ç–∞–≤–ª—è—é—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –¥–µ–Ω–µ–≥ –≤ –º–∞–≥–∞–∑–∏–Ω–µ.

**–ß—Ç–æ —è —Å–¥–µ–ª–∞–ª–∞:** –ü–æ—Å—á–∏—Ç–∞–ª–∞ –æ–±—â—É—é —Å—É–º–º—É –ø–æ–∫—É–ø–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –∏ –≤—ã–±—Ä–∞–ª–∞ –ø—è—Ç–µ—Ä—ã—Ö, –∫—Ç–æ –ø–æ—Ç—Ä–∞—Ç–∏–ª –±–æ–ª—å—à–µ –≤—Å–µ—Ö.

**–ó–∞–ø—Ä–æ—Å**:

**SELECT** customer_name, **SUM(sales)** as total_spent, **COUNT(*)** as orders_count

**FROM** superstore

**GROUP BY** customer_name

**ORDER BY** total_spent **DESC**

**LIMIT** 5;

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ:** –≠—Ç–∏ 5 –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏–Ω–æ—Å—è—Ç –æ–∫–æ–ª–æ 15% –≤—Å–µ–π –≤—ã—Ä—É—á–∫–∏. –ò—Ö —Å—Ç–æ–∏—Ç —Ü–µ–Ω–∏—Ç—å: –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–º –æ—Å–æ–±—ã–µ —É—Å–ª–æ–≤–∏—è, —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é —Å–∫–∏–¥–∫—É –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–∑–≤–æ–Ω–∏—Ç—å –∏ —Å–ø—Ä–æ—Å–∏—Ç—å, –∫–∞–∫ —É –Ω–∏—Ö –¥–µ–ª–∞. –¢–∞–∫ –∏—Ö –º–æ–∂–Ω–æ —É–¥–µ—Ä–∂–∞—Ç—å –∏ –ø–æ–±—É–¥–∏—Ç—å –ø–æ–∫—É–ø–∞—Ç—å –µ—â—ë –±–æ–ª—å—à–µ.

**5. –ö–∞–∫ —Ç–æ–≤–∞—Ä—ã —Å–≤—è–∑–∞–Ω—ã —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏?**

**–ó–∞–¥–∞—á–∞:** –£–≤–∏–¥–µ—Ç—å, –∫–∞–∫–æ–π –ø–æ—Å—Ç–∞–≤—â–∏–∫ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.

**–ß—Ç–æ —è —Å–¥–µ–ª–∞–ª–∞:** –°–æ–µ–¥–∏–Ω–∏–ª–∞ —Ç–∞–±–ª–∏—Ü—É —Å –ø—Ä–æ–¥–∞–∂–∞–º–∏ –∏ —Ç–∞–±–ª–∏—Ü—É —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏ –ø–æ –ø–æ–ª—é ¬´–∫–∞—Ç–µ–≥–æ—Ä–∏—è¬ª.

**–ó–∞–ø—Ä–æ—Å**:

**SELECT** superstore.product_name, superstore.category, suppliers.supplier_name

**FROM** superstore

**JOIN** suppliers **ON** superstore.category = suppliers.category;

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª:** –¢–µ–ø–µ—Ä—å –≤–∏–¥–Ω–∞ –ø–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞: —Ç–æ–≤–∞—Ä ‚Üí –µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Üí –ø–æ—Å—Ç–∞–≤—â–∏–∫. –≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏–≤–∞—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏ –Ω–∞–¥—ë–∂–Ω—ã–µ –∏ –¥–æ–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å—Å—è —Å –Ω–∏–º–∏ –æ–± —É—Å–ª–æ–≤–∏—è—Ö.

**6. –ï—Å—Ç—å –ª–∏ —Ç–æ–≤–∞—Ä—ã –±–µ–∑ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤?**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è, —á—Ç–æ –Ω–∞ –≤–∞–∂–Ω—ã–π —Ç–æ–≤–∞—Ä –Ω–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞. –≠—Ç–æ —Ä–∏—Å–∫.

**–ß—Ç–æ —è —Å–¥–µ–ª–∞–ª–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ **LEFT JOIN**, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –Ω–µ—Ç –∑–∞–ø–∏—Å–∏.

**–ó–∞–ø—Ä–æ—Å**:

**SELECT** superstore.product_name, superstore.category, suppliers.supplier_name

**FROM** superstore

**LEFT JOIN** suppliers **ON** superstore.category = suppliers.category;

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:** –¢–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è –æ—Ç–¥–µ–ª–∞ –∑–∞–∫—É–ø–æ–∫. –û–Ω —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –ø–æ –∫–∞–∫–∏–º –ø–æ–∑–∏—Ü–∏—è–º –Ω–µ—Ç —è—Å–Ω–æ—Å—Ç–∏ —Å –ø–æ—Å—Ç–∞–≤–∫–∞–º–∏. –ó–Ω–∞—á–∏—Ç, –ø–æ –Ω–∏–º –Ω—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞–¥—ë–∂–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω—ë—Ä–∞, —á—Ç–æ–±—ã –Ω–µ –æ—Å—Ç–∞—Ç—å—Å—è –±–µ–∑ —Ç–æ–≤–∞—Ä–∞.

# üìä –ö–∞–∫ —ç—Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ä–∞–±–æ—Ç–µ?

**–ú–∞—Ä–∫–µ—Ç–æ–ª–æ–≥–∞–º:** –í–∫–ª–∞–¥—ã–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–∏–ª—ã –∏ –±—é–¥–∂–µ—Ç –≤ —Ä–µ–∫–ª–∞–º—É –ú–µ–±–µ–ª–∏ (Furniture) –∏ —Ç–æ–ø–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.

**–ú–µ–Ω–µ–¥–∂–µ—Ä–∞–º –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º:** –ó–Ω–∞—Ç—å —Å–≤–æ–∏—Ö –ª—É—á—à–∏—Ö 5 –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –ª–∏—Ü–æ, –æ–±—â–∞—Ç—å—Å—è —Å –Ω–∏–º–∏ –ª–∏—á–Ω–æ, –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å —á—Ç–æ-—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ, —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ —É—à–ª–∏ –∫ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞–º.

**–û—Ç–¥–µ–ª—É –∑–∞–∫—É–ø–æ–∫:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—Ä–æ—Å –∫–∞–∫ —Å–∏–≥–Ω–∞–ª, –≥–¥–µ –≤ —Ü–µ–ø–æ—á–∫–µ –ø–æ—Å—Ç–∞–≤–æ–∫ –µ—Å—Ç—å —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞ –∏ —Å—Ä–æ—á–Ω–æ –∏—Ö —É—Å—Ç—Ä–∞–Ω—è—Ç—å.

–í—Å–µ - –∑–∞–ø—Ä–æ—Å—ã –∏–∑ —ç—Ç–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ –ª–µ–∂–∞—Ç –≤ –ø–∞–ø–∫–µ sql/ –ø—Ä–æ–µ–∫—Ç–∞.




